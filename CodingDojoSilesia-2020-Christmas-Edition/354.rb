S,V,A=$*
Q=S.to_i
D=[]
l=s=i=0
A.split(?,).map{|n|c=s|1
s=n=~/(#*)(\d*)\./
loop{r=s
s=(v=?|>$`?c*V.to_i*Math.sin(i*2*Math::PI/Q*(55*2**($2.to_i-('H#A#G#FE#D#C'.index($1+$`)+10)/12.0)-2e-4).round(2)):r=0)<0?-1:1
(i+=1)>Q/$'.to_i&&s!=r&&break
D[l]=128+v
l+=1}
i=1}
puts ['RIFF'+([44+l,'WAVEfmt',16,1,1,Q,Q,1,8,'data',l]+D).pack('IA8ISSIISSA4IC*')].pack'm0'